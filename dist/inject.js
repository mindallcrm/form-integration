var g=Object.defineProperty;var f=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;var l=(t,i,e)=>i in t?g(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,d=(t,i)=>{for(var e in i||(i={}))p.call(i,e)&&l(t,e,i[e]);if(f)for(var e of f(i))h.call(i,e)&&l(t,e,i[e]);return t};var a=(t,i,e)=>new Promise((o,n)=>{var u=r=>{try{s(e.next(r))}catch(c){n(c)}},m=r=>{try{s(e.throw(r))}catch(c){n(c)}},s=r=>r.done?o(r.value):Promise.resolve(r.value).then(u,m);s((e=e.apply(t,i)).next())});const MINDALL_CRM={config:{url:"https://crm.mindall.co/api/api/lead/create/byExternalForm",prevent:!0,formId:"",inputs:{firstname:"",lastname:"",email:"",phone:"",propertyReference:"",notes:""},meta:{orgId:"",sourceId:"",source:""}},init(t,i){if(!t||!i||!i.inputs){console.error("[Mindall CRM] Plugin is not injected due to missing configuration");return}this.config=this.updateConfig(d({},this.config),i),this.config.meta.orgId=t,window.onload=()=>this.inject()},updateConfig(t,i){var e;for(const o in t){const n=(e=i[o])!=null?e:void 0;n!==void 0&&(typeof n=="object"&&!Array.isArray(n)&&n!==null?t[o]=this.updateConfig(t[o],n):t[o]=n)}return t},inject(){var t;(t=this.config.meta)!=null&&t.sourceId||this.setDefaultSourceId(),console.info("[Mindall CRM] Successfully installed")},setDefaultSourceId(){console.info("[Mindall CRM] Setting Source ID from title: '".concat(document.title,"'")),this.config.meta.sourceId=document.title},formatData(t){const i={};for(let e in this.config.inputs)i[e]=t.get(this.config.inputs[e]),i[e]===null&&delete i[e];for(let e in this.config.meta)i[e]=this.config.meta[e];return i},apiCall(t){return a(this,null,function*(){return fetch(this.config.url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})},handleFormSubmit(t){return a(this,null,function*(){t.preventDefault();const i=MINDALL_CRM.formatData(new FormData(t.target));MINDALL_CRM.apiCall(i).then(e=>a(this,null,function*(){if(!e.ok){const o=e.statusText||"Request failed";return Promise.reject(o)}MINDALL_CRM.config.prevent||t.target.submit()})).catch(e=>alert(e))})}};document.addEventListener("submit",t=>{t.target.tagName.toLowerCase()==="form"&&(MINDALL_CRM.config.formId&&MINDALL_CRM.config.formId!==t.target.id||MINDALL_CRM.handleFormSubmit(t))},!0),window.MINDALL_CRM=MINDALL_CRM;
